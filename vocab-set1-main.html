<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç¬¬ä¸€çµ„è©å½™å–®å­—å¡ï¼ˆç¿»è½‰ï¼‹ç™¼éŸ³ï¼‹æ”¶è—ï¼‹èªé€Ÿï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text"; }
    body {
      margin: 0;
      padding: 16px;
      background: #f5f5f5;
      display: flex;
      justify-content: center;
    }

    .app {
      width: 100%;
      max-width: 520px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      padding: 20px;
    }

    h1 { text-align: center; margin: 0 0 10px; }
    .subtitle { text-align: center; font-size: 12px; color: #777; margin-bottom: 10px; }

    /* èªéŸ³é€Ÿåº¦æŒ‰éˆ•åˆ— */
    .speed-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      margin-bottom: 10px;
      font-size: 12px;
      color: #666;
    }

    .speed-label {
      margin-right: 4px;
    }

    .speed-btn {
      border: none;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      cursor: pointer;
      background: #f0f0f0;
      color: #444;
    }

    .speed-btn.active {
      background: #ffd86b;
      color: #6b4300;
      font-weight: 600;
    }

    /* å¡ç‰‡ç¿»è½‰æ•ˆæœ */
    .card {
      width: 100%;
      perspective: 1000px;
      cursor: pointer;
      margin-bottom: 12px;
      position: relative;
      transition: margin-bottom .3s ease;
    }

    .card-inner {
      position: relative;
      width: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      z-index: 1;
    }
    .card.flipped .card-inner { transform: rotateY(180deg); }

    /* åè½‰æ™‚æ‹‰é–‹ç©ºé–“ï¼Œé¿å…é®ä½æŒ‰éˆ• */
    .card-expanded {
      margin-bottom: 180px; /* å¯æŒ‰éœ€è¦èª¿æ•´é«˜åº¦ */
    }

    .card-face {
      position: relative;
      width: 100%;
      min-height: 220px;
      padding: 18px;
      border: 1px solid #eee;
      border-radius: 14px;
      background: #fafafa;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }

    .card-front {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .jp-word-front {
      font-size: 40px;
      margin-bottom: 6px;
    }

    .front-hint {
      font-size: 12px;
      color: #777;
      text-align: center;
    }

    .card-back {
      position: absolute;
      top: 0;
      left: 0;
      transform: rotateY(180deg);
    }

    /* Table æ’ç‰ˆ */
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      margin-top: 6px;
    }

    th {
      text-align: left;
      width: 96px;
      padding: 6px 4px;
      color: #888;
      font-weight: 600;
      vertical-align: top;
    }

    td {
      padding: 6px 4px;
      color: #222;
    }

    /* ä¾‹å¥ç™¼éŸ³æŒ‰éˆ•ï¼ˆåªæœ‰ emojiï¼‰ */
    .audio-btn {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      padding: 0;
      margin-left: 6px;
    }

    /* å³ä¸Šè§’æ”¶è—â­ */
    .fav-icon {
      position: absolute;
      top: 8px;
      right: 12px;
      font-size: 22px;
      cursor: pointer;
      user-select: none;
      z-index: 5;
    }

    /* æ§åˆ¶å€ */
    .controls {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-top: 4px;
    }

    button.nav {
      flex: 1;
      padding: 10px 0;
      background: #eee;
      border: none;
      border-radius: 999px;
      font-size: 14px;
      cursor: pointer;
    }

    button.nav:disabled { opacity: .4; }

    .index {
      text-align: center;
      font-size: 12px;
      color: #777;
      margin-top: 6px;
    }

    .hard-count {
      text-align: center;
      font-size: 12px;
      color: #999;
      margin-top: 2px;
    }

    /* æŸ¥çœ‹æ”¶è—é›£å­—æŒ‰éˆ• */
    .hard-link-wrapper {
      margin-top: 10px;
      text-align: center;
    }

    .hard-link-btn {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #ffe8a3;
      color: #7a4b00;
      font-size: 13px;
      text-decoration: none;
      cursor: pointer;
    }
  </style>
</head>

<body>
<div class="app">
  <h1>ç¬¬ä¸€çµ„è©å½™å–®å­—å¡</h1>
  <div class="subtitle">é»æ“Šå¡ç‰‡åè½‰ï½œç¿»é è‡ªå‹•è®€å‡ºæ—¥æ–‡ï½œå³ä¸Šè§’â­æ”¶è—é›£å­—</div>

  <!-- èªé€Ÿæ§åˆ¶ -->
  <div class="speed-controls">
    <span class="speed-label">èªéŸ³é€Ÿåº¦ï¼š</span>
    <button class="speed-btn" data-rate="0.6">ğŸŒ è¶…æ…¢</button>
    <button class="speed-btn" data-rate="0.8">ğŸ¢ æ…¢</button>
    <button class="speed-btn active" data-rate="1.0">ğŸ˜€ æ™®é€š</button>
  </div>

  <!-- å¡ç‰‡ -->
  <div class="card" id="card">
    <!-- å³ä¸Šè§’æ”¶è—â­ -->
    <div class="fav-icon" id="favIcon">â˜†</div>

    <div class="card-inner">
      <!-- æ­£é¢ -->
      <div class="card-face card-front">
        <div class="jp-word-front" id="jpWordFront"></div>
        <div class="front-hint">ğŸ‘‰ é»æ“Šå¡ç‰‡æŸ¥çœ‹è©³ç´°å…§å®¹</div>
      </div>

      <!-- èƒŒé¢ï¼ˆtableï¼‰ -->
      <div class="card-face card-back">
        <table>
          <tr><th>è©æ€§</th><td id="posBack"></td></tr>
          <tr><th>ç¾…é¦¬éŸ³</th><td id="romajiBack"></td></tr>
          <tr><th>ä¸­æ–‡</th><td id="cnBack"></td></tr>

          <!-- æ¼¢å­—ï¼‹å‡åä¾‹å¥ -->
          <tr>
            <th>æ¼¢å­—å‡åä¾‹å¥</th>
            <td>
              <span id="exampleJpAlt"></span>
              <button class="audio-btn" id="audioSentenceAltBtn">ğŸ“¢</button>
            </td>
          </tr>

          <!-- å‡åä¾‹å¥ -->
          <tr>
            <th>æ—¥æ–‡ä¾‹å¥</th>
            <td>
              <span id="exampleJpBack"></span>
              <button class="audio-btn" id="audioSentenceBtn">ğŸ“¢</button>
            </td>
          </tr>

          <tr><th>ä¸­æ–‡ä¾‹å¥</th><td id="exampleCnBack"></td></tr>
          <tr><th>èªæ³•</th><td id="grammarBack"></td></tr>
        </table>
      </div>
    </div>
  </div>

  <!-- ä¸Šä¸€å€‹ï¼ä¸‹ä¸€å€‹ -->
  <div class="controls">
    <button class="nav" id="prevBtn">ä¸Šä¸€å€‹</button>
    <button class="nav" id="nextBtn">ä¸‹ä¸€å€‹</button>
  </div>

  <div class="index" id="indexInfo"></div>
  <div class="hard-count" id="hardCount"></div>

  <!-- æŸ¥çœ‹æ”¶è—é›£å­— -->
  <div class="hard-link-wrapper">
    <a class="hard-link-btn" id="hardLink" href="vocab-set1-hard-list.html" target="_blank">
      æŸ¥çœ‹æ”¶è—é›£å­—åˆ—è¡¨
    </a>
  </div>
</div>

<script>
  const vocab = [
    {
      jp:"ã‚ãŸã—",
      romaji:"watashi",
      pos:"åè©ï½œä»£åè©",
      cn:"æˆ‘",
      exampleJp:"ã‚ãŸã—ã¯ ã‚Šã‚“ã”ãŒ ã™ãã§ã™ã€‚",
      exampleJpAlt:"ç§ã¯ãƒªãƒ³ã‚´ãŒå¥½ãã§ã™ã€‚",
      exampleCn:"æˆ‘å–œæ­¡è˜‹æœã€‚",
      grammar:"å¸¸é…ã€Œã¯ã€ç•¶ä¸»é¡Œã€‚"
    },
    {
      jp:"ã‚ãªãŸ",
      romaji:"anata",
      pos:"ä»£åè©",
      cn:"ä½ ",
      exampleJp:"ã‚ãªãŸã¯ ã©ã“ã‹ã‚‰ ãã¾ã—ãŸã‹ã€‚",
      exampleJpAlt:"ã‚ãªãŸã¯ã©ã“ã‹ã‚‰æ¥ã¾ã—ãŸã‹ã€‚",
      exampleCn:"ä½ å¾å“ªè£¡ä¾†ï¼Ÿ",
      grammar:"å¯¦éš›å°è©±å°‘ç›´æ¥è¬›ã€Œä½ ã€ã€‚"
    },
    {
      jp:"ã‚ã®ã²ã¨",
      romaji:"ano hito",
      pos:"åè©",
      cn:"é‚£å€‹äºº",
      exampleJp:"ã‚ã®ã²ã¨ã¯ ã‹ã„ã—ã‚ƒã„ã‚“ã§ã™ã€‚",
      exampleJpAlt:"ã‚ã®äººã¯ä¼šç¤¾å“¡ã§ã™ã€‚",
      exampleCn:"é‚£å€‹äººæ˜¯å…¬å¸è·å“¡ã€‚",
      grammar:"ç¦®è²Œèªï¼šã‚ã®ã‹ãŸã€‚"
    },
    {
      jp:"ã‹ã‚Œ",
      romaji:"kare",
      pos:"ä»£åè©",
      cn:"ä»–",
      exampleJp:"ã‹ã‚Œã¯ ãŒãã›ã„ã§ã™ã€‚",
      exampleJpAlt:"å½¼ã¯å­¦ç”Ÿã§ã™ã€‚",
      exampleCn:"ä»–æ˜¯å­¸ç”Ÿã€‚",
      grammar:"æœ‰æ™‚å¯æŒ‡ã€Œç”·æœ‹å‹ã€ã€‚"
    },
    {
      jp:"ã‹ã®ã˜ã‚‡",
      romaji:"kanojo",
      pos:"ä»£åè©",
      cn:"å¥¹",
      exampleJp:"ã‹ã®ã˜ã‚‡ã¯ ã«ã»ã‚“ã˜ã‚“ã§ã™ã€‚",
      exampleJpAlt:"å½¼å¥³ã¯æ—¥æœ¬äººã§ã™ã€‚",
      exampleCn:"å¥¹æ˜¯æ—¥æœ¬äººã€‚",
      grammar:"äº¦å¯æŒ‡ã€Œå¥³æœ‹å‹ã€ã€‚"
    },
    {
      jp:"ãŒãã›ã„",
      romaji:"gakusei",
      pos:"åè©",
      cn:"å­¸ç”Ÿ",
      exampleJp:"ã‚ãŸã—ã¯ ãŒãã›ã„ã§ã™ã€‚",
      exampleJpAlt:"ç§ã¯å­¦ç”Ÿã§ã™ã€‚",
      exampleCn:"æˆ‘æ˜¯å­¸ç”Ÿã€‚",
      grammar:"N5 åŸºæœ¬è©ã€‚"
    },
    {
      jp:"ã“ã†ã“ã†ã›ã„",
      romaji:"koukousei",
      pos:"åè©",
      cn:"é«˜ä¸­ç”Ÿ",
      exampleJp:"ã„ã‚‚ã†ã¨ã¯ ã“ã†ã“ã†ã›ã„ã§ã™ã€‚",
      exampleJpAlt:"å¦¹ã¯é«˜æ ¡ç”Ÿã§ã™ã€‚",
      exampleCn:"å¦¹å¦¹æ˜¯é«˜ä¸­ç”Ÿã€‚",
      grammar:"é«˜æ ¡ï¼é«˜ä¸­ã€‚"
    },
    {
      jp:"ã‹ã„ã—ã‚ƒã„ã‚“",
      romaji:"kaishain",
      pos:"åè©",
      cn:"å…¬å¸è·å“¡",
      exampleJp:"ã¡ã¡ã¯ ã‹ã„ã—ã‚ƒã„ã‚“ã§ã™ã€‚",
      exampleJpAlt:"çˆ¶ã¯ä¼šç¤¾å“¡ã§ã™ã€‚",
      exampleCn:"çˆ¸çˆ¸æ˜¯å…¬å¸è·å“¡ã€‚",
      grammar:"æ³›æŒ‡ä¸Šç­æ—ã€‚"
    },
    {
      jp:"ã—ã‚ƒã„ã‚“",
      romaji:"shain",
      pos:"åè©",
      cn:"è·å“¡",
      exampleJp:"ï¼©ï¼´ã® ã—ã‚ƒã„ã‚“ã§ã™ã€‚",
      exampleJpAlt:"ITã®ç¤¾å“¡ã§ã™ã€‚",
      exampleCn:"æˆ‘æ˜¯ IT å…¬å¸çš„è·å“¡ã€‚",
      grammar:"é€šå¸¸è·Ÿå…¬å¸åã€‚"
    },
    {
      jp:"ã©ã†ã‚Šã‚‡ã†",
      romaji:"douryou",
      pos:"åè©",
      cn:"åŒäº‹",
      exampleJp:"ã©ã†ã‚Šã‚‡ã†ã¨ ã²ã‚‹ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã™ã€‚",
      exampleJpAlt:"åŒåƒšã¨æ˜¼ã”é£¯ã‚’é£Ÿã¹ã¾ã™ã€‚",
      exampleCn:"å’ŒåŒäº‹åƒåˆé¤ã€‚",
      grammar:"åŒéƒ¨é–€åŒäº‹ã€‚"
    },
    {
      jp:"ã—ã‚…ãµ",
      romaji:"shufu",
      pos:"åè©",
      cn:"å®¶åº­ä¸»å©¦",
      exampleJp:"ã¯ã¯ã¯ ã—ã‚…ãµã§ã™ã€‚",
      exampleJpAlt:"æ¯ã¯ä¸»å©¦ã§ã™ã€‚",
      exampleCn:"åª½åª½æ˜¯å®¶åº­ä¸»å©¦ã€‚",
      grammar:"äº¦å¯æŒ‡ç”·æ€§ä¸»å¤«ã€‚"
    },
    {
      jp:"ãŠãã«",
      romaji:"okuni",
      pos:"åè©ï¼ˆæ•¬èªï¼‰",
      cn:"æ‚¨çš„åœ‹å®¶",
      exampleJp:"ãŠãã«ã¯ ã©ã¡ã‚‰ã§ã™ã‹ã€‚",
      exampleJpAlt:"ãŠå›½ã¯ã©ã¡ã‚‰ã§ã™ã‹ã€‚",
      exampleCn:"è«‹å•æ‚¨æ˜¯å“ªä¸€åœ‹äººï¼Ÿ",
      grammar:"ãŠ + åœ‹å â†’ å°Šæ•¬ã€‚"
    },
    {
      jp:"ã«ã»ã‚“ã˜ã‚“",
      romaji:"nihonjin",
      pos:"åè©",
      cn:"æ—¥æœ¬äºº",
      exampleJp:"ã‹ã‚Œã¯ ã«ã»ã‚“ã˜ã‚“ã§ã™ã€‚",
      exampleJpAlt:"å½¼ã¯æ—¥æœ¬äººã§ã™ã€‚",
      exampleCn:"ä»–æ˜¯æ—¥æœ¬äººã€‚",
      grammar:"åœ‹å®¶åï¼‹ã˜ã‚“ã€‚"
    },
    {
      jp:"ã‚¢ãƒ¡ãƒªã‚«ã˜ã‚“",
      romaji:"amerikajin",
      pos:"åè©",
      cn:"ç¾åœ‹äºº",
      exampleJp:"ã‹ã®ã˜ã‚‡ã¯ ã‚¢ãƒ¡ãƒªã‚«ã˜ã‚“ã§ã™ã€‚",
      exampleJpAlt:"å½¼å¥³ã¯ã‚¢ãƒ¡ãƒªã‚«äººã§ã™ã€‚",
      exampleCn:"å¥¹æ˜¯ç¾åœ‹äººã€‚",
      grammar:"å¤–ä¾†èªåœ‹åï¼‹ã˜ã‚“ã€‚"
    },
    {
      jp:"ãŸã„ã‚ã‚“",
      romaji:"taiwan",
      pos:"åè©",
      cn:"å°ç£",
      exampleJp:"ã‚ãŸã—ã¯ ãŸã„ã‚ã‚“ã‹ã‚‰ ãã¾ã—ãŸã€‚",
      exampleJpAlt:"ç§ã¯å°æ¹¾ã‹ã‚‰æ¥ã¾ã—ãŸã€‚",
      exampleCn:"æˆ‘ä¾†è‡ªå°ç£ã€‚",
      grammar:"å¸¸ç”¨æ–¼è‡ªæˆ‘ä»‹ç´¹ã€‚"
    }
  ];

  const STORAGE_KEY = "vocabSet1_hardWords";

  const card              = document.getElementById("card");
  const favIcon           = document.getElementById("favIcon");
  const jpWordFront       = document.getElementById("jpWordFront");
  const posBack           = document.getElementById("posBack");
  const romajiBack        = document.getElementById("romajiBack");
  const cnBack            = document.getElementById("cnBack");
  const exampleJpBack     = document.getElementById("exampleJpBack");
  const exampleJpAlt      = document.getElementById("exampleJpAlt");
  const exampleCnBack     = document.getElementById("exampleCnBack");
  const grammarBack       = document.getElementById("grammarBack");
  const audioSentenceBtn  = document.getElementById("audioSentenceBtn");
  const audioSentenceAltBtn = document.getElementById("audioSentenceAltBtn");

  const prevBtn   = document.getElementById("prevBtn");
  const nextBtn   = document.getElementById("nextBtn");
  const indexInfo = document.getElementById("indexInfo");
  const hardCountEl = document.getElementById("hardCount");
  const hardLink  = document.getElementById("hardLink");

  const speedBtns = document.querySelectorAll(".speed-btn");
  let speechRate = 1.0;

  let idx = 0;
  let hardSet = new Set();

  function loadHardFromStorage() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (raw) {
        hardSet = new Set(JSON.parse(raw));
      }
    } catch(e) {
      hardSet = new Set();
    }
  }

  function saveHardToStorage() {
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(hardSet)));
    } catch(e) {}
  }

  // æ›´æ–°ã€ŒæŸ¥çœ‹æ”¶è—é›£å­—åˆ—è¡¨ã€çš„ URL åƒæ•¸
  function updateHardLinkHref() {
    const arr = Array.from(hardSet);
    const query = encodeURIComponent(JSON.stringify(arr));
    hardLink.href = "vocab-set1-hard-list.html?words=" + query;
  }

  function speak(text) {
    if (!("speechSynthesis" in window)) return;
    const u = new SpeechSynthesisUtterance(text);
    u.lang = "ja-JP";
    u.rate = speechRate;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }

  function updateFavIcon() {
    const w = vocab[idx].jp;
    const isHard = hardSet.has(w);
    favIcon.textContent = isHard ? "â˜…" : "â˜†";
    hardCountEl.textContent = `å·²æ”¶è—é›£å­—ï¼š${hardSet.size} å€‹`;
    updateHardLinkHref();
  }

  function loadCard(autoSpeak = true) {
    const v = vocab[idx];

    jpWordFront.textContent   = v.jp;
    posBack.textContent       = v.pos;
    romajiBack.textContent    = v.romaji;
    cnBack.textContent        = v.cn;
    exampleJpAlt.textContent  = v.exampleJpAlt;
    exampleJpBack.textContent = v.exampleJp;
    exampleCnBack.textContent = v.exampleCn;
    grammarBack.textContent   = v.grammar;

    indexInfo.textContent = `ç¬¬ ${idx + 1} / ${vocab.length} å€‹`;
    prevBtn.disabled = idx === 0;
    nextBtn.disabled = idx === vocab.length - 1;

    updateFavIcon();
    if (autoSpeak) speak(v.jp);
  }

  // èªé€ŸæŒ‰éˆ•äº‹ä»¶
  const speedButtons = document.querySelectorAll(".speed-btn");
  speedButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      speedButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      speechRate = parseFloat(btn.dataset.rate || "1.0");
      speak(vocab[idx].jp);
    });
  });

  // é»å¡ç‰‡ï¼šåè½‰ï¼ˆä½†æŒ‰éˆ•/æ˜Ÿæ˜Ÿå””åï¼‰ï¼Œä¸¦æ§åˆ¶é«˜åº¦
  card.addEventListener("click", (e) => {
    if (
      e.target === favIcon ||
      e.target === audioSentenceBtn ||
      e.target === audioSentenceAltBtn
    ) return;

    card.classList.toggle("flipped");
    card.classList.toggle("card-expanded");
  });

  prevBtn.onclick = () => {
    if (idx > 0) {
      idx--;
      card.classList.remove("flipped", "card-expanded");
      loadCard(true);
    }
  };

  nextBtn.onclick = () => {
    if (idx < vocab.length - 1) {
      idx++;
      card.classList.remove("flipped", "card-expanded");
      loadCard(true);
    }
  };

  audioSentenceBtn.onclick = (e) => {
    e.stopPropagation();
    speak(vocab[idx].exampleJp);
  };

  audioSentenceAltBtn.onclick = (e) => {
    e.stopPropagation();
    speak(vocab[idx].exampleJpAlt);
  };

  // é»å³ä¸Šè§’â­æ”¶è— / å–æ¶ˆæ”¶è—
  favIcon.onclick = (e) => {
    e.stopPropagation();
    const w = vocab[idx].jp;
    if (hardSet.has(w)) hardSet.delete(w);
    else hardSet.add(w);
    saveHardToStorage();
    updateFavIcon();
  };

  loadHardFromStorage();
  loadCard(true);
</script>

</body>
</html>
